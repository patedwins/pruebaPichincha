/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn more about Gradle by exploring our samples at https://docs.gradle.org/7.2/samples
 */
plugins {
    id 'java'
    id 'maven-publish'
}

allprojects {
    group = 'com.pichincha.transaccion.api'
    version = '1.0.0'  
    
    sourceCompatibility = JavaVersion.VERSION_1_8
    targetCompatibility = JavaVersion.VERSION_1_8

    repositories {
        mavenLocal()
        mavenCentral()
        maven {
            url 'https://nexus.seps.gob.ec/repository/seps-maven-group/'
            credentials {
                username = System.getenv('PICHINCHA_MAVEN_USER')
                password = System.getenv('PICHINCHA_MAVEN_PASSWORD')
            }
        }
    }
}


subprojects {
    apply plugin: 'java'
    apply plugin: 'maven-publish'

    java {
        sourceCompatibility = JavaVersion.VERSION_1_8
        targetCompatibility = JavaVersion.VERSION_1_8
    }

    compileJava {
        sourceCompatibility = JavaVersion.VERSION_1_8
        targetCompatibility = JavaVersion.VERSION_1_8
        options.encoding = 'UTF-8'
    }


    publishing {
        repositories {
            maven {
                def releasesRepoUrl = 'https://nexus.seps.gob.ec/repository/seps-mvn-releases/'
                def snapshotsRepoUrl = 'https://nexus.seps.gob.ec/repository/seps-mvn-snapshot/'
                url = version.endsWith('SNAPSHOT')?snapshotsRepoUrl:releasesRepoUrl
                credentials {
                    username = System.getenv('PICHINCHA_MAVEN_USER')
                    password = System.getenv('PICHINCHA_MAVEN_PASSWORD')
                }
            }
        }
        publications {
            mavenJava(MavenPublication) {
                from components.java
                versionMapping {
                    usage('java-api') {
                        fromResolutionOf('runtimeClasspath')
                    }
                    usage('java-runtime') {
                        fromResolutionResult()
                    }
                }
            }
        }
    }

}